<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="个人学习小结"><title>ES6 | zlstory</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ES6</h1><a id="logo" href="/.">zlstory</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ES6</h1><div class="post-meta">Jul 14, 2017</div><a data-disqus-identifier="2017/07/14/es6_2/" href="/2017/07/14/es6_2/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><h2 id="es6学习笔记-下"><a href="#es6学习笔记-下" class="headerlink" title="es6学习笔记(下)"></a>es6学习笔记(下)</h2><h3 id="Proxy（代理）和Reflect（反射）的概念"><a href="#Proxy（代理）和Reflect（反射）的概念" class="headerlink" title="Proxy（代理）和Reflect（反射）的概念"></a>Proxy（代理）和Reflect（反射）的概念</h3><a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> obj = &#123;</div><div class="line">        time:<span class="string">'2017-7-18'</span>,</div><div class="line">        name:<span class="string">'Crystal'</span>,</div><div class="line">        _r:<span class="number">123</span></div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">let</span> monitor = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj,&#123;</div><div class="line">        <span class="comment">//拦截对象属性的读取</span></div><div class="line">        get(target,key)&#123;</div><div class="line">            <span class="keyword">return</span> target[key].replace(<span class="string">'2017'</span>,<span class="string">'2018'</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">//拦截对象属性的设置</span></div><div class="line">        set(target,key,value)&#123;</div><div class="line">            <span class="comment">//只允许修改name属性</span></div><div class="line">            <span class="keyword">if</span>(key === <span class="string">"name"</span>)&#123;</div><div class="line">                <span class="keyword">return</span> target[key] = value;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> target[key];</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">//判断当前对象中是否有某属性</span></div><div class="line">        has(target,key,value)&#123;</div><div class="line">            <span class="keyword">if</span>(key === <span class="string">'name'</span>)&#123;</div><div class="line">                <span class="keyword">return</span> target [key];</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">//删除</span></div><div class="line">        deleteProperty(target,key)&#123;</div><div class="line">            <span class="keyword">if</span>(key.indexOf(<span class="string">"_"</span>)&gt;<span class="number">-1</span>)&#123;</div><div class="line">                <span class="keyword">delete</span> target[key];</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> target[key];</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="comment">//拦截object.keys、object.getOwnPropertySymbols、object.getOwnPropertyNames</span></div><div class="line">        ownKeys(target)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="built_in">Object</span>.target(target).filter(<span class="function"><span class="params">item</span> =&gt;</span> item != <span class="string">"time"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="built_in">console</span>.log(monitor.time);<span class="comment">//2018-7-18</span></div><div class="line">    monitor.time = <span class="string">"2018"</span>;</div><div class="line">    <span class="built_in">console</span>.log( monitor.time);<span class="comment">//2018-7-18(无修改)</span></div><div class="line">    monitor.name = <span class="string">"Sinsle"</span>;</div><div class="line">    <span class="built_in">console</span>.log(monitor.name);<span class="comment">//Sinsle(已修改)</span></div><div class="line"></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"name"</span> <span class="keyword">in</span> monitor,<span class="string">"time"</span> <span class="keyword">in</span> monitor);</div><div class="line"></div><div class="line">    <span class="keyword">delete</span> monitor.time;</div><div class="line">    <span class="built_in">console</span>.log(monitor);<span class="comment">//没有删除time</span></div><div class="line"></div><div class="line">    <span class="keyword">delete</span> monitor._r;</div><div class="line">    <span class="built_in">console</span>.log(monitor);<span class="comment">//删除_r属性</span></div><div class="line"></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'ownkeys'</span>,<span class="built_in">Object</span>.keys(monitor));</div><div class="line">    </div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;   <span class="comment">//Reflect的方法与属性和Proxy相同</span></div><div class="line">     <span class="keyword">let</span> obj = &#123;</div><div class="line">        time:<span class="string">'2017-7-18'</span>,</div><div class="line">        name:<span class="string">'Crystal'</span>,</div><div class="line">        _r:<span class="number">123</span></div><div class="line">    &#125;;</div><div class="line">    <span class="built_in">console</span>.log(<span class="built_in">Reflect</span>.get(obj,<span class="string">"time"</span>));<span class="comment">//2017-7-18</span></div><div class="line">    <span class="built_in">Reflect</span>.set(obj,<span class="string">"name"</span>,<span class="string">"sinsle"</span>);</div><div class="line">    <span class="built_in">console</span>.log(obj);</div><div class="line">    <span class="built_in">console</span>.log(<span class="built_in">Reflect</span>.has(obj,<span class="string">"name"</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Proxy和Reflect的适用场景"><a href="#Proxy和Reflect的适用场景" class="headerlink" title="Proxy和Reflect的适用场景"></a>Proxy和Reflect的适用场景</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">validator</span>(<span class="params">target,validator</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target,&#123;</div><div class="line">            _validator:validator,</div><div class="line">            set(target,key,value,proxy)&#123;</div><div class="line">                <span class="keyword">if</span>(target.hasOwnProperty(key))&#123;</div><div class="line">                    <span class="keyword">let</span> val = <span class="keyword">this</span>._validator[key];</div><div class="line">                    <span class="keyword">if</span>(!!val(value))&#123;</div><div class="line">                        <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target,key,value,proxy)</div><div class="line">                    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                        <span class="keyword">throw</span> <span class="built_in">Error</span> (<span class="string">`不能设置<span class="subst">$&#123;key&#125;</span>到<span class="subst">$&#123;value&#125;</span>`</span>)</div><div class="line">                    &#125;</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span> 不存在`</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">const</span> personValidator = &#123;</div><div class="line">        name(val)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">"string"</span>;</div><div class="line">        &#125;,</div><div class="line">        age(val) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">"number"</span> &amp;&amp; val &gt;=<span class="number">18</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name,age)&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">            <span class="keyword">this</span>.age = age;</div><div class="line">            <span class="keyword">return</span> validator(<span class="keyword">this</span>,personValidator);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">const</span> person = <span class="keyword">new</span> Person(<span class="string">"Crystal"</span>,<span class="number">23</span>);</div><div class="line">    <span class="built_in">console</span>.log(person);<span class="comment">//Proxy &#123;name: "Crystal", age: 23&#125;</span></div><div class="line"></div><div class="line">    person.name = <span class="number">48</span>;<span class="comment">//报错：不能设置name到48</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><p>基本定义与生成实例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name = "crystal")&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> v_parent = <span class="keyword">new</span> Parent(<span class="string">'v'</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'构造函数和实例'</span>,v_parent);<span class="comment">//构造函数和实例 Parent &#123;name: "v"&#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name = "crystal")&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;       </div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"继承"</span>,<span class="keyword">new</span> Child());<span class="comment">//继承 Child &#123;name: "crystal"&#125;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">     <span class="comment">//子类传递给父类 super</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name = "crystal")&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;       </div><div class="line">        <span class="keyword">constructor</span>(name = "zilan")&#123;</div><div class="line">            <span class="keyword">super</span>(name);<span class="comment">//super需在第一行</span></div><div class="line">            <span class="keyword">this</span>.type = <span class="string">"child"</span>;<span class="comment">//定义自己属性时需要有this关键字，在super之后</span></div><div class="line">            </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"传递属性"</span>,<span class="keyword">new</span> Child());<span class="comment">//传递属性 Child &#123;name: "zilan", type: "child"&#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name = "crystal")&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">static</span> tell()&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"静态方法"</span>);<span class="comment">//通过类来调用，不通过类的实例调用</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    Parent.tell();<span class="comment">//静态方法</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="静态属性"><a href="#静态属性" class="headerlink" title="静态属性"></a>静态属性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name = "crystal")&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">static</span> tell()&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"静态方法"</span>);<span class="comment">//static定义静态方法</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//定义静态属性</span></div><div class="line">    Parent.type = <span class="string">"静态属性"</span>;</div><div class="line">    <span class="built_in">console</span>.log(Parent.type);</div><div class="line"></div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="getter与setter"><a href="#getter与setter" class="headerlink" title="getter与setter"></a>getter与setter</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&#123;  </div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</div><div class="line">        <span class="keyword">constructor</span>(name = "crystal")&#123;</div><div class="line">            <span class="keyword">this</span>.name = name;</div><div class="line">        &#125;</div><div class="line">   </div><div class="line">        get longName()&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">'love '</span> + <span class="keyword">this</span>.name;</div><div class="line">        &#125;</div><div class="line">        set longName(value)&#123;</div><div class="line">            <span class="keyword">this</span>.name = value;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> v = <span class="keyword">new</span> Parent();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"getter:"</span>,v.longName);<span class="comment">//getter: love crystal</span></div><div class="line">    v.longName = <span class="string">"sinsle"</span>;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"setter:"</span>,v.longName);<span class="comment">//setter: love sinsle</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><h4 id="什么是异步"><a href="#什么是异步" class="headerlink" title="什么是异步"></a>什么是异步</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> ajax = <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"执行"</span>);</div><div class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            callback &amp;&amp; callback.call()   </div><div class="line">        &#125;,<span class="number">1000</span>)</div><div class="line">    &#125;;</div><div class="line">    ajax(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"timeout1"</span>);</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> ajax = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"执行2"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</div><div class="line">            setTimeout( <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                resolve()</div><div class="line">            &#125;,<span class="number">1000</span>);</div><div class="line">        &#125;)</div><div class="line">    &#125;;</div><div class="line">    ajax().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"promise"</span>,<span class="string">"setTimeout2"</span>);</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> ajax = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"执行3"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</div><div class="line">            setTimeout( <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                resolve()</div><div class="line">            &#125;,<span class="number">1000</span>);</div><div class="line">        &#125;)</div><div class="line">    &#125;;</div><div class="line">    ajax().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</div><div class="line">            setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                resolve();</div><div class="line">            &#125;,<span class="number">2000</span>)</div><div class="line">        &#125;);</div><div class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'timeout3'</span>)</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;   <span class="comment">//catch捕获错误</span></div><div class="line">    <span class="keyword">let</span> ajax = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"执行4"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span>(num&gt;<span class="number">5</span>)&#123;</div><div class="line">                resolve();</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'出错了'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ajax(<span class="string">"str"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'log'</span>,<span class="number">6</span>);</div><div class="line">    &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"catch"</span>,err);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>所有图片加载完成再加载图片</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span>&#123;</div><div class="line">            <span class="keyword">let</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</div><div class="line">            img.src = src;</div><div class="line">            img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                resolve(img);</div><div class="line">            &#125;</div><div class="line">            img.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">                reject(err);</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">showImgs</span>(<span class="params">imgs</span>)</span>&#123;</div><div class="line">        imgs.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">img</span>)</span>&#123;</div><div class="line">            <span class="built_in">document</span>.body.appendChild(img);</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">Promise</span>.all([</div><div class="line">        loadImg(<span class="string">'https://img.alicdn.com/tfs/TB11rUOSXXXXXXVaXXXXXXXXXXX-520-280.jpg_q90_.webp'</span>),</div><div class="line">        loadImg(<span class="string">'https://img.alicdn.com/tfs/TB1SpARSXXXXXaCapXXXXXXXXXX-520-280.jpg_q90_.webp'</span>),</div><div class="line">        loadImg(<span class="string">'https://img.alicdn.com/simba/img/TB1J.5xSXXXXXbJXFXXSutbFXXX.jpg'</span>)</div><div class="line">    ]).then(showImgs);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>谁先加载完成就先显示<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span>&#123;</div><div class="line">            <span class="keyword">let</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</div><div class="line">            img.src = src;</div><div class="line">            img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                resolve(img);</div><div class="line">            &#125;</div><div class="line">            img.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">                reject(err);</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">showImgs</span>(<span class="params">imgs</span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> p = <span class="built_in">document</span>.createElement(<span class="string">'p'</span>);</div><div class="line">        p.appendChild(img);</div><div class="line">        <span class="built_in">document</span>.body.appendChild(p);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">Promise</span>.race([<span class="comment">//有一个状态改变 则改变  只显示一张图片 其他忽略</span></div><div class="line">        loadImg(<span class="string">'https://img.alicdn.com/tfs/TB11rUOSXXXXXXVaXXXXXXXXXXX-520-280.jpg_q90_.webp'</span>),</div><div class="line">        loadImg(<span class="string">'https://img.alicdn.com/tfs/TB1SpARSXXXXXaCapXXXXXXXXXX-520-280.jpg_q90_.webp'</span>),</div><div class="line">        loadImg(<span class="string">'https://img.alicdn.com/simba/img/TB1J.5xSXXXXXbJXFXXSutbFXXX.jpg'</span>)</div><div class="line">    ]).then(showImgs);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Iterator和for-of循环"><a href="#Iterator和for-of循环" class="headerlink" title="Iterator和for  of循环"></a>Iterator和for  of循环</h3><h4 id="什么是Iterator"><a href="#什么是Iterator" class="headerlink" title="什么是Iterator"></a>什么是Iterator</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> arr = [<span class="string">'hello'</span>,<span class="string">'world'</span>];</div><div class="line">    <span class="keyword">let</span> map = arr[<span class="built_in">Symbol</span>.iterator]();</div><div class="line">    <span class="built_in">console</span>.log(map.next());</div><div class="line">    <span class="built_in">console</span>.log(map.next());</div><div class="line">    <span class="built_in">console</span>.log(map.next());</div><div class="line">    <span class="comment">// Object &#123;value: "hello", done: false&#125;</span></div><div class="line">    <span class="comment">// Object &#123;value: "world", done: false&#125;</span></div><div class="line">    <span class="comment">// Object &#123;value: undefined, done: true&#125; true代表循环结束</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Iterator的基本用法"><a href="#Iterator的基本用法" class="headerlink" title="Iterator的基本用法"></a>Iterator的基本用法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&#123;   <span class="comment">//先遍历start,再遍历end</span></div><div class="line">    <span class="keyword">let</span> obj = &#123;</div><div class="line">        start:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],</div><div class="line">        end:[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],</div><div class="line">        [<span class="built_in">Symbol</span>.iterator]()&#123;</div><div class="line">            <span class="keyword">let</span> self = <span class="keyword">this</span>;</div><div class="line">            <span class="keyword">let</span> index = <span class="number">0</span>;</div><div class="line">            <span class="keyword">let</span> arr = self.start.concat(self.end);</div><div class="line">            <span class="keyword">let</span> len = arr.length;</div><div class="line">            <span class="keyword">return</span> &#123;</div><div class="line">                next()&#123;</div><div class="line">                    <span class="keyword">if</span>(index&lt;len)&#123;</div><div class="line">                        <span class="keyword">return</span> &#123;</div><div class="line">                            value:arr[index++],</div><div class="line">                            done:<span class="literal">false</span></div><div class="line">                        &#125;</div><div class="line">                    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                        <span class="keyword">return</span> &#123;</div><div class="line">                            value:arr[index++],</div><div class="line">                            done:<span class="literal">true</span></div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">of</span> obj)&#123;</div><div class="line">        <span class="built_in">console</span>.log(key);<span class="comment">//1 2 3 4  7 8 9 </span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="for…of"><a href="#for…of" class="headerlink" title="for…of"></a>for…of</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> arr = [<span class="string">'hello'</span>,<span class="string">'world'</span>];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> arr)&#123;</div><div class="line">        <span class="built_in">console</span>.log(value);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h3><h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> tell = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">        <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">        <span class="keyword">return</span>  <span class="string">'c'</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> k = tell();</div><div class="line">    <span class="built_in">console</span>.log(k.next());</div><div class="line">    <span class="built_in">console</span>.log(k.next());</div><div class="line">    <span class="built_in">console</span>.log(k.next());</div><div class="line">    <span class="built_in">console</span>.log(k.next());</div><div class="line"></div><div class="line">    <span class="comment">//Object &#123;value: "a", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "b", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "c", done: true&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: undefined, done: true&#125;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> obj = &#123;&#125;;</div><div class="line">    obj[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">        <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> obj)&#123;</div><div class="line">        <span class="built_in">console</span>.log(value);<span class="comment">//1 2 3</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="comment">//一个事务只有三个状态</span></div><div class="line">    <span class="keyword">let</span> state = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">yield</span> <span class="string">'A'</span>;</div><div class="line">            <span class="keyword">yield</span> <span class="string">'B'</span>;</div><div class="line">            <span class="keyword">yield</span> <span class="string">'C'</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> states = state();</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="comment">//Object &#123;value: "A", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "B", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "C", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "A", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "B", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "C", done: false&#125;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="comment">//另一种方法</span></div><div class="line">    <span class="keyword">let</span> state = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">await</span> <span class="string">'A'</span>;</div><div class="line">            <span class="keyword">await</span> <span class="string">'B'</span>;</div><div class="line">            <span class="keyword">await</span> <span class="string">'C'</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> states = state();</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="built_in">console</span>.log(states.next());</div><div class="line">    <span class="comment">//Object &#123;value: "A", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "B", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "C", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "A", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "B", done: false&#125;</span></div><div class="line">    <span class="comment">//Object &#123;value: "C", done: false&#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>抽奖次数的限制</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> draw = <span class="function"><span class="keyword">function</span>(<span class="params">count</span>)</span>&#123;</div><div class="line">        <span class="comment">//具体抽奖次数</span></div><div class="line"></div><div class="line">        <span class="built_in">console</span>.info(<span class="string">`剩余<span class="subst">$&#123;count&#125;</span>次数`</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> residue = <span class="function"><span class="keyword">function</span>* (<span class="params">count</span>)</span>&#123;</div><div class="line">        <span class="keyword">while</span> (count&gt;<span class="number">0</span>)&#123;</div><div class="line">            count --;</div><div class="line">            <span class="keyword">yield</span> draw(count);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> star = residue(<span class="number">5</span>);</div><div class="line">    <span class="keyword">let</span> btn = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</div><div class="line">    btn.id = <span class="string">'start'</span>;</div><div class="line">    btn.textContent = <span class="string">"抽奖"</span>;</div><div class="line">    documnent.body.appendChild(btn);</div><div class="line">    docunment.getELementById(<span class="string">'start'</span>).addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        star.next();</div><div class="line">    &#125;,<span class="literal">false</span>)</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">    <span class="comment">//长轮询</span></div><div class="line">    <span class="keyword">let</span> ajax = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">yield</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</div><div class="line">            setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                resolve(&#123;code200&#125;);</div><div class="line">            &#125;,<span class="number">2000</span>)</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> pull = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> genertaor = ajax();</div><div class="line">        <span class="keyword">let</span> step = genertaor.next();</div><div class="line">        step.value.then(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span>(d.code != <span class="number">0</span>)&#123;</div><div class="line">                setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                    <span class="built_in">console</span>.log(<span class="string">"wait"</span>);</div><div class="line">                    pull()</div><div class="line">                &#125;,<span class="number">1000</span>)</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(d);</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    pull();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h3><h4 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h4><p>npm install babel-plugin-transform-decorators-legacy –save-dev<br>修改babellrc文件<br>“plugins”:[“transform-decorators-legacy”]</p>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p>修饰器是一个函数  类class<br>第三方修饰器库：core-decorators:npm install core-decorators<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> readonly = <span class="function"><span class="keyword">function</span>(<span class="params">target,name,descriptor</span>)</span>&#123;</div><div class="line">        descriptor.weitable = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">return</span> descriptor</div><div class="line">    &#125;;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</div><div class="line">        @readonly</div><div class="line">        time()&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"2017-07-19"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> test = <span class="keyword">new</span> Test();</div><div class="line">    <span class="comment">//修改</span></div><div class="line">    test.time = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"修改了时间"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(test.time());<span class="comment">//报错</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> typename = <span class="function"><span class="keyword">function</span>(<span class="params">target,name,descriptor</span>)</span>&#123;</div><div class="line">        target.myname = <span class="string">"hello"</span>;</div><div class="line">    &#125;</div><div class="line">    @typename</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"类修饰符"</span>,Test.myname);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><h4 id="基本概念-2"><a href="#基本概念-2" class="headerlink" title="基本概念"></a>基本概念</h4><h4 id="ES6的模块化语法"><a href="#ES6的模块化语法" class="headerlink" title="ES6的模块化语法"></a>ES6的模块化语法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&#123;   <span class="comment">//A文件中导出</span></div><div class="line">    <span class="keyword">export</span> <span class="keyword">let</span> A = <span class="string">'123'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"test"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</div><div class="line">        test()&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"class"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//导出的建议写法  更方便命名</span></div><div class="line">    <span class="keyword">let</span> A = <span class="number">123</span>;</div><div class="line">    <span class="keyword">let</span> test = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"class"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</div><div class="line">        test()&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"class"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    esport <span class="keyword">default</span>&#123;</div><div class="line">        A,</div><div class="line">        test,</div><div class="line">        Hello</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//用import导入</span></div><div class="line">    <span class="comment">//B文件中</span></div><div class="line">    <span class="keyword">import</span> &#123;A,test,Hello&#125; <span class="keyword">from</span> A</div><div class="line"></div><div class="line">    <span class="comment">//当文件很多的时候  导入小技巧</span></div><div class="line">    <span class="keyword">import</span> * <span class="keyword">as</span> lesson <span class="keyword">from</span> <span class="string">'A'</span>;</div><div class="line">    <span class="built_in">console</span>.log(lesson.A,lesson.test);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p></p><p style="color: rgb(114, 171, 200);font-size:14px;margin:14px;font-family:Arial">真正的离开是不会有任何预警的。</p><p></p>
</div><div class="tags"><a href="/tags/javaScript/">javaScript</a><a href="/tags/es6/">es6</a></div><div class="post-nav"><a href="/2017/07/25/responsive/" class="pre">响应式开发</a><a href="/2017/07/14/es6_1/" class="next">ES6</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'zlstory';
var disqus_identifier = '2017/07/14/es6_2/';
var disqus_title = 'ES6';
var disqus_url = 'http://zlstory.com/2017/07/14/es6_2/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/next/config.json',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//zlstory.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/javaScript/" style="font-size: 15px;">javaScript</a> <a href="/tags/javaScript小知识/" style="font-size: 15px;">javaScript小知识</a> <a href="/tags/Array/" style="font-size: 15px;">Array</a> <a href="/tags/es6/" style="font-size: 15px;">es6</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/jQuery/" style="font-size: 15px;">jQuery</a> <a href="/tags/JSON/" style="font-size: 15px;">JSON</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/html/" style="font-size: 15px;">html</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/选择器/" style="font-size: 15px;">选择器</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/vue/" style="font-size: 15px;">vue</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/11/28/webpack/">浅谈前端项目模块化工具webpack</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/26/js-basic/">JavaScript核心-ECMAScript</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/26/vue/">vue入门知识小结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/09/JavaScript/">JavaScript</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/24/hexo/">hexo个人博客</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/25/responsive/">响应式开发</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/es6_2/">ES6</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/es6_1/">ES6</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/10/react2/">React</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/10/react3/">React</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//zlstory.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://sinsle.com/" title="休克" target="_blank">休克</a><ul></ul><a href="https://www.wujiabk.com" title="吴佳博客" target="_blank">吴佳博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">zlstory.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>